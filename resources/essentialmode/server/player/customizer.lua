-- Requires total rewrite as the current code is shit so just removed it all.